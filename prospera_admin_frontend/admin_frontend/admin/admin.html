<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Prospera - Site para ajudar no controle financeiro e estabelecer metas e ajudar a alcançar seus objetivos.">
    <meta name="keywords" content="Prospera, controle financeiro, metas financeiras, objetivos financeiros, planejamento financeiro, finanças pessoais">
    <meta name="author" content="KaMark14, @kamarques_14, Kauã Marques, Prospera Team">
    <title>Admin - Prospera</title>
    <link rel="stylesheet" href="assets/css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Página de Login -->
    <div class="login-container" id="loginContainer">
        <div class="login-box fade-in">
            <h1 class="login-title">Admin Prospera</h1>
            <form class="login-form" id="loginForm">
                <input type="text" placeholder="Usuário Admin" id="adminUsername" required>
                <input type="password" placeholder="Senha" id="adminPassword" required>
                <button type="submit">Entrar</button>
                <div class="login-error" id="loginError">Credenciais inválidas. Tente novamente.</div>
            </form>
        </div>
    </div>

    <!-- Dashboard Admin -->
    <div class="admin-container" id="adminContainer" style="display: none;">
        <!-- Sidebar -->
        <div class="admin-sidebar" id="adminSidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">
                    <i class="fas fa-chart-line" style="font-size: 1.8rem; margin-right: 10px;"></i>
                    Prospera Admin
                </div>
                <div class="sidebar-user">
                    <div class="sidebar-avatar" id="adminAvatar">A</div>
                    <div class="sidebar-user-info">
                        <div class="sidebar-username" id="adminUsernameDisplay">Admin</div>
                        <div class="sidebar-user-role">Administrador</div>
                    </div>
                </div>
            </div>

            <div class="sidebar-menu">
                <div class="menu-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    Dashboard
                </div>
                <div class="menu-item" data-section="users">
                    <i class="fas fa-users"></i>
                    Usuários
                </div>
                <div class="menu-item" data-section="goals">
                    <i class="fas fa-bullseye"></i>
                    Metas
                </div>
                <div class="menu-item" data-section="profile">
                    <i class="fas fa-user-circle"></i>
                    Meu Perfil
                </div>
                <div class="menu-item" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    Sair
                </div>
            </div>
        </div>

        <!-- Conteúdo Principal -->
        <div class="admin-main">
            <div class="admin-header">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="page-title" id="pageTitle">Dashboard</h1>
            </div>

            <section id="dashboard">
                <!-- Seção Dashboard -->
                <div class="admin-section active" id="dashboardSection">
                    <div class="admin-stats">
                        <div class="stat-card">
                            <div class="stat-value" id="totalUsers">0</div>
                            <div class="stat-label">Total de Usuários</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="activeGoals">0</div>
                            <div class="stat-label">Metas Ativas</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="completedGoals">0</div>
                            <div class="stat-label">Metas Concluídas</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="newUsers">0</div>
                            <div class="stat-label">Novos (7 dias)</div>
                        </div>
                    </div>

                    <div class="admin-table-container">
                        <div class="table-header">
                            <div class="table-title">Metas Recentes</div>
                            <div class="table-actions">
                                <button class="table-action-btn">
                                    <i class="fas fa-search"></i>
                                    Buscar
                                </button>
                                <button class="table-action-btn">
                                    <i class="fas fa-download"></i>
                                    Exportar
                                </button>
                            </div>
                        </div>

                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Meta</th>
                                    <th>Usuário</th>
                                    <th>Data</th>
                                    <th>Valor</th>
                                    <th>Progresso</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="dashboardGoalsTbody">
                                <!-- Linhas preenchidas dinamicamente por admin.js -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="users">
                <!-- Seção Usuários -->
                <div class="admin-section" id="usersSection">
                    <div class="admin-table-container">
                        <div class="table-header">
                            <div class="table-title">Todos os Usuários</div>
                            <div class="table-actions">
                                <button class="table-action-btn" id="addUserBtn" data-modal-target="addUserModal">
                                    <i class="fas fa-plus"></i>
                                    Novo Usuário
                                </button>
                                <button class="table-action-btn">
                                    <i class="fas fa-search"></i>
                                    Buscar
                                </button>
                                <button class="table-action-btn">
                                    <i class="fas fa-download"></i>
                                    Exportar
                                </button>
                            </div>
                        </div>

                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Usuário</th>
                                    <th>Email</th>
                                    <th>Registro</th>
                                    <th>Metas</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Tabela de usuários preenchida dinamicamente via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="goals">
                <!-- Seção Metas -->
                <div class="admin-section" id="goalsSection">
                    <div class="admin-table-container">
                        <div class="table-header">
                            <div class="table-title">Todas as Metas</div>
                            <div class="table-actions">
                                <button class="table-action-btn">
                                    <i class="fas fa-search"></i>
                                    Buscar
                                </button>
                                <button class="table-action-btn">
                                    <i class="fas fa-download"></i>
                                    Exportar
                                </button>
                            </div>
                        </div>

                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Meta</th>
                                    <th>Usuário</th>
                                    <th>Valor Alvo</th>
                                    <th>Progresso</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="goalsTbody">
                                <!-- Linhas preenchidas dinamicamente por admin.js -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="profile">
                <!-- Seção Perfil -->
                <div class="admin-section" id="profileSection">
                    <div class="admin-table-container">
                        <div class="table-header">
                            <div class="table-title">Meu Perfil</div>
                        </div>

                        <div style="padding: 2rem;">
                            <div style="display: flex; margin-bottom: 2rem; align-items: center;">
                                <div class="sidebar-avatar profile-avatar" id="profileAvatar"
                                     style="width: 100px; height: 100px; font-size: 2.5rem; margin-right: 1.5rem;">A
                                </div>
                                <div>
                                    <h2 id="profileName" style="font-size: 1.8rem; margin-bottom: 0.5rem; color: var(--primary-color);">Admin</h2>
                                    <p id="profileRole" style="color: var(--text-light); margin-bottom: 1rem;">Administrador do Sistema</p>
                                    <button class="profile-btn primary" id="editAdminProfileBtn" data-modal-target="editProfileModal">
                                        <i class="fas fa-edit" style="margin-right: 8px;"></i>Editar Perfil
                                    </button>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                <div>
                                    <h3 style="font-size: 1.2rem; margin-bottom: 1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; color: var(--primary-color);">
                                        Informações Pessoais
                                    </h3>
                                    <div style="margin-bottom: 1.5rem;">
                                        <p style="color: var(--text-light); font-size: 0.9rem;">Nome completo</p>
                                        <p id="profileFullName">Administrador do Sistema</p>
                                    </div>
                                    <div style="margin-bottom: 1.5rem;">
                                        <p style="color: var(--text-light); font-size: 0.9rem;">Email</p>
                                        <p id="profileEmail">admin@prospera.com</p>
                                    </div>
                                    <div style="margin-bottom: 1.5rem;">
                                        <p style="color: var(--text-light); font-size: 0.9rem;">Data de registro</p>
                                        <p id="profileJoinDate">01/01/2023</p>
                                    </div>
                                </div>

                                <div>
                                    <h3 style="font-size: 1.2rem; margin-bottom: 1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; color: var(--primary-color);">
                                        Segurança
                                    </h3>
                                    <div style="margin-bottom: 1.5rem;">
                                        <p style="color: var(--text-light); font-size: 0.9rem;">Último login</p>
                                        <p id="lastLoginTime">Hoje às 14:30</p>
                                    </div>
                                    <div style="margin-bottom: 1.5rem;">
                                        <p style="color: var(--text-light); font-size: 0.9rem;">Alterar senha</p>
                                        <button class="profile-btn secondary" id="changePasswordBtn" data-modal-target="changePasswordModal">
                                            <i class="fas fa-key" style="margin-right: 8px;"></i>Alterar Senha
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Modal de Confirmação -->
    <div class="confirm-modal" id="confirmModal">
        <div class="confirm-container">
            <h3 class="confirm-title" id="confirmTitle">Confirmar ação</h3>
            <p class="confirm-message" id="confirmMessage">Tem certeza que deseja realizar esta ação?</p>
            <div class="confirm-buttons">
                <button class="confirm-btn cancel" id="cancelConfirmBtn">Cancelar</button>
                <button class="confirm-btn confirm" id="confirmActionBtn">Confirmar</button>
            </div>
        </div>
    </div>

     <!-- Modal de editar perfil do admin-->
    <div class="modal-overlay" id="editProfileModal" style="display:none;">
        <div class="modal edit-profile-modal" role="dialog" aria-modal="true" aria-labelledby="editProfileTitle">
            <div style="display:flex; align-items:center; justify-content:space-between; gap: 1rem;">
                <h3 id="editProfileTitle">Editar Perfil</h3>
                <button class="modal-close" id="closeEditProfileBtn" aria-label="Fechar">&times;</button>
            </div>

            <form id="editProfileForm" class="modal-form" novalidate>
                <div class="form-row">
                    <label for="editFullName">Nome completo</label>
                    <input type="text" id="editFullName" name="fullName" required minlength="2" />
                </div>
                <div class="form-row">
                    <label for="editEmail">Email</label>
                    <input type="email" id="editEmail" name="email" required />
                </div>
                <div class="form-row">
                    <label for="editRole">Cargo</label>
                    <input type="text" id="editRole" name="role" readonly />
                </div>

                <div class="form-row">
                    <label for="editJoinDate">Data de registro</label>
                    <input type="text" id="editJoinDate" name="joinDate" readonly />
                </div>

                <div class="form-error" id="editProfileError" aria-live="polite" style="display:none;"></div>

                <div class="modal-actions">
                    <button type="button" class="confirm-btn cancel" id="cancelEditProfileBtn">Cancelar</button>
                    <button type="submit" class="confirm-btn confirm" id="submitEditProfileBtn">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de visualizar usuario -->
    <div class="modal-overlay" id="viewUserModal" style="display:none;">
        <div class="modal view-user-modal" role="dialog" aria-modal="true" aria-labelledby="viewUserTitle">
            <div style="display:flex; align-items:center; justify-content:space-between; gap: 1rem;">
                <h3 id="viewUserTitle">Visualizar Usuário</h3>
                <button class="modal-close" id="closeViewUserBtn" aria-label="Fechar">&times;</button>
            </div>

            <div class="view-user-body" style="display:grid; grid-template-columns: 84px 1fr; gap: 1rem; align-items:center; margin-top: 0.6rem;">
                <div style="display:flex; align-items:center; justify-content:center;">
                    <div class="sidebar-avatar profile-avatar" id="viewUserAvatar" style="width:72px; height:72px; font-size:1.6rem;">U</div>
                </div>

                <div>
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div style="margin-bottom: 0.35rem;">
                            <div id="viewUserName" style="font-weight:700; font-size:1.05rem;">Nome do Usuário</div>
                            <div id="viewUserRole" style="color:var(--text-light); font-size:0.9rem;">Cargo / Perfil</div>
                        </div>
                        <div style="text-align:right;">
                            <div id="viewUserEmail" style="font-weight:600; color:var(--primary-color);"></div>
                            <div id="viewUserPhone" style="font-size:0.85rem; color:var(--text-light);"></div>
                        </div>
                    </div>

                    <div style="margin-top: 0.75rem; display:flex; gap:1rem; flex-wrap:wrap;">
                        <div style="min-width:160px;">
                            <div style="font-size:0.85rem; color:var(--text-light)">Data de registro</div>
                            <div id="viewUserJoinDate" style="font-weight:600;"></div>
                        </div>
                        <div style="min-width:160px;">
                            <div style="font-size:0.85rem; color:var(--text-light)">Último login</div>
                            <div id="viewUserLastLogin" style="font-weight:600;"></div>
                        </div>
                    </div>

                    <div class="form-error" id="viewUserError" style="display:none; margin-top:0.75rem;"></div>

                    <div style="margin-top: 1rem; display:flex; gap:0.5rem; justify-content:flex-end;">
                        <button class="confirm-btn cancel" id="closeViewUserBtn2">Fechar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de editar usuario -->
    <div class="modal-overlay" id="editUserModal" style="display:none;">
        <div class="modal edit-user-modal" role="dialog" aria-modal="true" aria-labelledby="editUserTitle">
            <div style="display:flex; align-items:center; justify-content:space-between; gap: 1rem;">
                <h3 id="editUserTitle">Editar Usuário</h3>
                <button class="modal-close" id="closeEditUserModalBtn" aria-label="Fechar">&times;</button>
            </div>

            <form id="editUserForm" class="modal-form" novalidate>
                <input type="hidden" id="editUserId" />

                <div class="form-row">
                    <label for="editUserFullName">Nome completo</label>
                    <input type="text" id="editUserFullName" name="fullName" required minlength="2" />
                </div>

                <div class="form-row">
                    <label for="editUserEmail">Email</label>
                    <input type="email" id="editUserEmail" name="email" required />
                </div>

                <div class="form-row">
                    <label for="editUserPhone">Telefone</label>
                    <input type="text" id="editUserPhone" name="phone" />
                </div>

                <div class="form-row">
                    <label for="editUserRole">Cargo</label>
                    <input type="text" id="editUserRole" name="role" />
                </div>

                <div class="form-row">
                    <label for="editUserStatus">Status</label>
                    <select id="editUserStatus" name="status">
                        <option value="Ativo">Ativo</option>
                        <option value="Inativo">Inativo</option>
                    </select>
                </div>

                <div class="form-row">
                    <label for="editUserJoinDate">Data de registro</label>
                    <input type="text" id="editUserJoinDate" name="joinDate" readonly />
                </div>

                <div class="form-error" id="editUserError" aria-live="polite" style="display:none;"></div>

                <div class="modal-actions">
                    <button type="button" class="confirm-btn cancel" id="cancelEditUserBtn">Cancelar</button>
                    <button type="submit" class="confirm-btn confirm" id="submitEditUserBtn">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de alterar senha do admin -->
    <div class="modal-overlay" id="changePasswordModal" style="display:none;">
        <div class="modal change-password-modal" role="dialog" aria-modal="true" aria-labelledby="changePasswordTitle">
            <div style="display:flex; align-items:center; justify-content:space-between; gap: 1rem;">
                <h3 id="changePasswordTitle">Alterar senha</h3>
                <button class="modal-close" id="closeChangePasswordBtn" aria-label="Fechar">&times;</button>
            </div>

            <form id="changePasswordForm" class="modal-form" novalidate>
                <div class="form-row">
                    <label for="currentPassword">Senha atual</label>
                    <input type="password" id="currentPassword" name="currentPassword" required minlength="6" autocomplete="current-password" />
                </div>

                <div class="form-row">
                    <label for="newPassword">Nova senha</label>
                    <input type="password" id="newPassword" name="newPassword" required minlength="8" autocomplete="new-password" />
                </div>

                <div class="form-row">
                    <label for="confirmNewPassword">Confirmar nova senha</label>
                    <input type="password" id="confirmNewPassword" name="confirmNewPassword" required minlength="8" autocomplete="new-password" />
                </div>

                <div class="form-error" id="changePasswordError" aria-live="polite" style="display:none;"></div>

                <div class="modal-actions">
                    <button type="button" class="confirm-btn cancel" id="cancelChangePasswordBtn">Cancelar</button>
                    <button type="submit" class="confirm-btn confirm" id="submitChangePasswordBtn">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de adicionar novo usuario -->
    <div class="modal-overlay" id="addUserModal" style="display:none;">
        <div class="modal add-user-modal" role="dialog" aria-modal="true" aria-labelledby="addUserTitle">
            <div style="display:flex; align-items:center; justify-content:space-between; gap: 1rem;">
                <h3 id="addUserTitle">Adicionar Novo Usuário</h3>
                <button class="modal-close" id="closeAddUserModalBtn" aria-label="Fechar">&times;</button>
            </div>

            <form id="addUserForm" class="modal-form" novalidate>
                <div class="form-row">
                    <label for="addUserFullName">Nome completo</label>
                    <input type="text" id="addUserFullName" name="fullName" required minlength="2" />
                </div>

                <div class="form-row">
                    <label for="addUserEmail">Email</label>
                    <input type="email" id="addUserEmail" name="email" required />
                </div>

                <div class="form-row">
                    <label for="addUserPhone">Telefone</label>
                    <input type="text" id="addUserPhone" name="phone" />
                </div>

                <div class="form-row">
                    <label for="addUserRole">Cargo</label>
                    <input type="text" id="addUserRole" name="role" />
                </div>

                <div class="form-row">
                    <label for="addUserStatus">Status</label>
                    <select id="addUserStatus" name="status">
                        <option value="Ativo">Ativo</option>
                        <option value="Inativo">Inativo</option>
                    </select>
                </div>

                <div class="form-row">
                    <label for="addUserPassword">Senha</label>
                    <input type="password" id="addUserPassword" name="password" required minlength="8" />
                </div>
                <div class="form-row">
                    <label for="addUserPasswordConfirm">Confirmar senha</label>
                    <input type="password" id="addUserPasswordConfirm" name="passwordConfirm" required minlength="8" />
                </div>

                <div class="form-error" id="addUserError" aria-live="polite" style="display:none;"></div>

                <div class="modal-actions">
                    <button type="button" class="confirm-btn cancel" id="cancelAddUserBtn">Cancelar</button>
                    <button type="submit" class="confirm-btn confirm" id="submitAddUserBtn">Criar</button>
                </div>
            </form>
        </div>
    </div>

</body>
<script src="assets/js/admin.js"></script>
</html>